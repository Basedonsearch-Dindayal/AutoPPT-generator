# Enhanced AutoPPT Generator - Setup Instructions

## Overview
The AutoPPT Generator has been enhanced with improved code structure and image generation capabilities using the Unsplash API.

## New File Structure

```
├── server.js              # Main Express server (refactored)
├── routes/
│   └── ppt.js             # PowerPoint generation route with image support
├── middleware/
│   └── errorHandler.js    # Centralized error handling middleware
└── ... (existing files)
```

## Environment Variables

Create a `.env` file in the root directory with the following variables:

```env
# Required
GEMINI_API_KEY=your_google_gemini_api_key_here

# Optional but recommended for image features
UNSPLASH_ACCESS_KEY=your_unsplash_access_key_here

# Optional
FRONTEND_URL=your_frontend_url_here
PORT=5000
NODE_ENV=production
```

### Getting API Keys

1. **Gemini API Key**: 
   - Visit [Google AI Studio](https://makersuite.google.com/app/apikey)
   - Create a new API key for your project

2. **Unsplash Access Key**:
   - Visit [Unsplash Developers](https://unsplash.com/developers)
   - Create a new application
   - Copy the "Access Key" (not the Secret Key)

## New Features

### 1. Image Generation
- Each slide now includes a `visualHint` field generated by Gemini AI
- The system automatically searches Unsplash for relevant images
- Images are fetched, converted to base64, and embedded in slides
- Graceful fallback to placeholder if image fetching fails

### 2. Improved Error Handling
- Centralized error handling middleware
- Better error categorization and user-friendly messages
- Request timing for performance monitoring

### 3. Code Structure
- Separated route logic from main server file
- Modular middleware for reusability
- Enhanced maintainability and readability

## API Usage

The `/generate-ppt` endpoint remains the same:

```javascript
POST /generate-ppt
Content-Type: application/json

{
  "topic": "Artificial Intelligence in Healthcare",
  "slideCount": 5,
  "presentationStyle": "professional",
  "audienceLevel": "general", 
  "includeConclusion": true,
  "colorTheme": "blue"
}
```

## Performance Notes

- Image fetching is done in parallel for better performance
- Request timeout is 5 seconds for image search, 10 seconds for download
- If Unsplash API is not configured, the system works without images
- Requests are rate-limited to 10 per 15 minutes per IP

## Development

To run the server:

```bash
npm install
npm run start:backend
```

For development with auto-reload:

```bash
npm run dev:all
```

## Image Attribution

When using images from Unsplash, the system stores attribution information. Consider adding proper attribution in your presentation footer if required by your use case.